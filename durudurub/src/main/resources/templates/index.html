<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{/layouts/main_layout}">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>두루두룹 - 함께 하면 더 즐거운 순간</title>
    <link rel="stylesheet" th:href="@{/css/index.css}">

</head>
<body layout:fragment="content">

    <!-- 히어로 -->
    <section class="hero-section">
        <div class="hero-container">
            <div class="hero-content">
                <div class="hero-text">
                    <h1 class="hero-title">
                        함께 하면<br>더 즐거운 순간
                    </h1>
                    <p class="hero-subtitle">
                        관심사가 같은 사람들과 모여<br>새로운 경험을 만들어보세요
                    </p>
                    <a th:href="@{/club/list}" class="hero-btn">모임 둘러보기</a>
                </div>

                <!-- 히어로 이미지 -->
                <div class="hero-image-wrapper">
                    <img src="/img/hero-image.png" alt="함께하는 즐거운 순간">
                    <div class="hero-image-overlay"></div>
                </div>
            </div>
        </div>
    </section>

    <!-- 광고 배너 섹션 -->
    <section class="ad-section" th:if="${banners != null and !banners.empty}">
        <div class="ad-sponsored">Sponsored</div>
        <div class="ad-banner-wrapper" id="bannerSlider">

            </th:block>
            
            <!-- 배너 개수만큼 dot 표시 -->
            <div class="ad-banner-dots" th:if="${#lists.size(banners) > 1}">
                <div th:each="b, stat : ${banners}" 
                     class="ad-dot"
                     th:classappend="${stat.first ? 'active' : ''}"
                     th:attr="data-index=${stat.index}"
                     onclick="goToBannerSlide(this.dataset.index)"></div>
            </div>
        </div>
    </section>

    <!-- 카테고리 -->
    <section class="category-section">
        <div class="category-header">
            <h2 class="category-title">어떤 모임을 찾으시나요?</h2>
            <p class="category-subtitle">관심있는 카테고리를 선택해보세요</p>
        </div>

        <div class="category-grid">
            <!-- 카테고리 반복 -->
            <a th:each="category : ${categories}" 
               th:href="@{/club/category(category=${category.no})}" 
               class="category-item">
                <div class="category-icon">
                    <!-- 카테고리 아이콘 -->
                    <img th:src="${category.icon}" 
                         th:alt="${category.name}" 
                         onerror="this.src='/img/default-profile.png';" />
                </div>
                <span class="category-name" th:text="${category.name}">카테고리명</span>
            </a>
        </div>
    </section>

    <!-- 배너 슬라이드 -->
    <th:block layout:fragment="script">
        <script th:if="${banners != null and !banners.empty}">
            let currentBannerIndex = 0;
            const bannerSlides = document.querySelectorAll('.banner-slide');
            const bannerDots = document.querySelectorAll('.ad-dot');
            const totalBanners = bannerSlides.length;
            let bannerInterval;

            // 배너 슬라이드 표시 함수
            function showBannerSlide(index) {
                // 모든 슬라이드 숨김
                bannerSlides.forEach(slide => {
                    slide.style.display = 'none';
                });
                
                // 모든 dot 비활성화
                bannerDots.forEach(dot => {
                    dot.classList.remove('active');
                });
                
                // 현재 슬라이드 표시
                if (bannerSlides[index]) {
                    bannerSlides[index].style.display = 'block';
                }
                
                // 현재 dot 활성화
                if (bannerDots[index]) {
                    bannerDots[index].classList.add('active');
                }
                
                currentBannerIndex = index;
            }

            // 다음 슬라이드
            function nextBannerSlide() {
                let nextIndex = (currentBannerIndex + 1) % totalBanners;
                showBannerSlide(nextIndex);
            }

            // 특정 슬라이드로 이동
            function goToBannerSlide(index) {
                showBannerSlide(parseInt(index));
                // 수동 클릭 시 자동 슬라이드 재시작
                clearInterval(bannerInterval);
                startBannerAutoSlide();
            }

            // 자동 슬라이드 시작
            function startBannerAutoSlide() {
                if (totalBanners > 1) {
                    bannerInterval = setInterval(nextBannerSlide, 5000); // 5초마다 변경
                }
            }

            // 페이지 로드 시 자동 슬라이드 시작
            if (totalBanners > 1) {
                startBannerAutoSlide();
            }
        </script>
    </th:block>
</body>
</html>