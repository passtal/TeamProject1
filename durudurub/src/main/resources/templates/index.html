<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{/layouts/main_layout}">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë‘ë£¨ë‘ë£¹ - í•¨ê»˜ í•˜ë©´ ë” ì¦ê±°ìš´ ìˆœê°„</title>
    <link rel="stylesheet" th:href="@{/css/index.css}">

</head>
<body layout:fragment="content">

    <!-- íˆì–´ë¡œ -->
    <section class="hero-section">
        <div class="hero-container">
            <div class="hero-content">
                <div class="hero-text">
                    <h1 class="hero-title">
                        í•¨ê»˜ í•˜ë©´<br>ë” ì¦ê±°ìš´ ìˆœê°„
                    </h1>
                    <p class="hero-subtitle">
                        ê´€ì‹¬ì‚¬ê°€ ê°™ì€ ì‚¬ëŒë“¤ê³¼ ëª¨ì—¬<br>ìƒˆë¡œìš´ ê²½í—˜ì„ ë§Œë“¤ì–´ë³´ì„¸ìš”
                    </p>
                    <a th:href="@{/club/list}" class="hero-btn">ëª¨ì„ ë‘˜ëŸ¬ë³´ê¸°</a>
                </div>

                <!-- íˆì–´ë¡œ ì´ë¯¸ì§€ -->
                <div class="hero-image-wrapper">
                    <img th:src="@{/img/index/main_img.jpg}" 
                         alt="í•¨ê»˜í•˜ëŠ” ì¦ê±°ìš´ ìˆœê°„">
                    <div class="hero-image-overlay"></div>
                </div>
            </div>
        </div>
    </section>

    <!-- ê´‘ê³  ë°°ë„ˆ ì„¹ì…˜ -->
    <section class="ad-section" th:if="${banners != null and !banners.empty}">
        <div class="ad-sponsored">Sponsored</div>
        <div class="ad-banner-wrapper" id="bannerSlider">
            <!-- ë°°ë„ˆ ìŠ¬ë¼ì´ë“œ -->
            <div class="ad-banner-track" id="ad-banner-track">
                <div class="banner-slide" th:each="b : ${banners}">
                    <a th:href="${b.linkUrl}">
                        <img class="ad-banner-img" th:src="${b.imageUrl}" th:alt="${b.title}">
                    </a>
                </div>
            </div>
            <!-- ë°°ë„ˆ ê°œìˆ˜ë§Œí¼ dot í‘œì‹œ -->
            <div class="ad-banner-dots" th:if="${#lists.size(banners) > 1}">
                <div th:each="b, stat : ${banners}" 
                     class="ad-dot"
                     th:classappend="${stat.first ? 'active' : ''}"
                     th:attr="data-index=${stat.index}"
                     onclick="goToBannerSlide(this.dataset.index)"></div>
            </div>
        </div>
    </section>

    <!-- Category Section -->
    <section class="category-section">
        <div class="category-header">
            <h2 class="category-title">ì–´ë–¤ ëª¨ì„ì„ ì°¾ìœ¼ì‹œë‚˜ìš”?</h2>
            <p class="category-subtitle">ê´€ì‹¬ìˆëŠ” ì¹´í…Œê³ ë¦¬ë¥¼ ì„ íƒí•´ë³´ì„¸ìš”</p>
        </div>

        <div class="category-grid">
            <!-- ì¹´í…Œê³ ë¦¬ ë°˜ë³µ -->
            <a th:each="category, iterStat : ${categories}" 
               th:href="@{/club/list(category=${category.no})}" 
               class="category-item">
                <div class="category-icon" 
                     th:classappend="'category-bg-' + ${(iterStat.index % 8) + 1}">
                    <!-- Bootstrap Icons (bi-*) í´ë˜ìŠ¤ì¸ ê²½ìš° -->
                    <i th:if="${category.icon != null and category.icon.startsWith('bi-')}" 
                       th:class="'bi ' + ${category.icon}"></i>
                    <!-- URLì¸ ê²½ìš° ì´ë¯¸ì§€ -->
                    <img th:if="${category.icon != null and category.icon.startsWith('http')}" 
                         th:src="${category.icon}" 
                         th:alt="${category.name}">
                    <!-- ê·¸ ì™¸ (ì´ëª¨ì§€ ë“±) -->
                    <span th:if="${category.icon != null and !category.icon.startsWith('bi-') and !category.icon.startsWith('http')}" 
                          th:text="${category.icon}">ğŸ“</span>
                </div>
                <span class="category-name" th:text="${category.name}">ì¹´í…Œê³ ë¦¬ëª…</span>
            </a>
        </div>
    </section>

    <!-- ë°°ë„ˆ ìŠ¬ë¼ì´ë“œ -->
    <th:block layout:fragment="script">
        <script th:if="${banners != null and !banners.empty}">
            document.addEventListener('DOMContentLoaded', () => {
                let currentBannerIndex = 0;

                const bannertrack = document.getElementById('ad-banner-track');
                const bannerSlides = document.querySelectorAll('#ad-banner-track .banner-slide');
                const bannerDots = document.querySelectorAll('.ad-dot');
                const totalBanners = bannerSlides.length;

                let bannerInterval;

                function updateDots(index) {
                    bannerDots.forEach(d => d.classList.remove('active'));
                    if (bannerDots[index]) bannerDots[index].classList.add('active');
                }

                function showBannerSlide(index) {
                    if (!bannertrack || totalBanners === 0) return;
                    if (index < 0) index = totalBanners - 1;
                    if (index >= totalBanners) index = 0;
                    bannertrack.style.transform = `translateX(-${index * 100}%)`;
                    currentBannerIndex = index;
                    updateDots(index);
                }

                function nextBannerSlide() {
                    showBannerSlide(currentBannerIndex + 1);
                }

                window.goToBannerSlide = function (index) {
                    showBannerSlide(parseInt(index, 10));
                    clearInterval(bannerInterval);
                    startBannerAutoSlide();
                }

                function startBannerAutoSlide() {
                    if (totalBanners > 1) {
                        bannerInterval = setInterval(nextBannerSlide, 5000);
                    }
                }

                showBannerSlide(0);
                startBannerAutoSlide();
            })
        </script>
    </th:block>
</body>
</html>