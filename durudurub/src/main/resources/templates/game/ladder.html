<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{/layouts/main_layout}">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>사다리 게임 - 두루두룹</title>
        <th:block layout:fragment="css">
            <link rel="stylesheet" th:href="@{/css/game/ladder.css}">
        </th:block>
        <th:block layout:fragment="script">
            <script th:src="@{/js/ladder.js}"></script>
        </th:block>
    </head>
    <body>
        <main layout:fragment="content" class="ladder-page">
            <!-- 뒤로가기 버튼 -->
            <div class="back-button-container">
                <a href="/game/list" class="back-button">
                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M12.5 15L7.5 10L12.5 5" stroke="#364153" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    <span>게임 선택으로 돌아가기</span>
                </a>
            </div>

            <!-- 메인 컨테이너 -->
            <div class="ladder-container">
                <!-- 사다리 설정 -->
                <div class="ladder-settings">
                    <h2>사다리 설정</h2>
                    
                    <div class="settings-content">
                        <!-- 참가자 수 조절 -->
                        <div class="setting-section">
                            <label class="setting-label">참가자 수: <span id="participantCount">4</span>명</label>
                            <div class="slider-container">
                                <button class="slider-button" id="decreaseBtn">
                                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M5 10H15" stroke="#364153" stroke-width="2" stroke-linecap="round"/>
                                    </svg>
                                </button>
                                <div class="slider-track">
                                    <div class="slider-fill" id="sliderFill"></div>
                                </div>
                                <button class="slider-button" id="increaseBtn">
                                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M10 5V15M5 10H15" stroke="#364153" stroke-width="2" stroke-linecap="round"/>
                                    </svg>
                                </button>
                            </div>
                        </div>

                        <!-- 참가자 이름 입력 -->
                        <div class="setting-section">
                            <label class="setting-label">참가자 이름</label>
                            <div class="input-grid" id="participantInputs">
                                <input type="text" class="text-input" placeholder="참가자1" value="참가자1">
                                <input type="text" class="text-input" placeholder="참가자2" value="참가자2">
                                <input type="text" class="text-input" placeholder="참가자3" value="참가자3">
                                <input type="text" class="text-input" placeholder="참가자4" value="참가자4">
                            </div>
                        </div>

                        <!-- 결과/상품 입력 -->
                        <div class="setting-section">
                            <label class="setting-label">결과/상품</label>
                            <div class="input-grid" id="prizeInputs">
                                <input type="text" class="text-input" placeholder="1등" value="1등">
                                <input type="text" class="text-input" placeholder="2등" value="2등">
                                <input type="text" class="text-input" placeholder="3등" value="3등">
                                <input type="text" class="text-input" placeholder="4등" value="4등">
                            </div>
                        </div>

                        <!-- 사다리 생성 버튼 -->
                        <button class="generate-button" id="generateBtn">
                            <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M17.5 10.833C17.5 14.975 14.142 18.333 10 18.333C5.858 18.333 2.5 14.975 2.5 10.833C2.5 6.692 5.858 3.333 10 3.333C11.392 3.333 12.708 3.7 13.842 4.333M17.5 3.333L10 10.833L7.917 8.75" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                            사다리 생성
                        </button>
                    </div>
                </div>

                <!-- 사다리 타기 (숨김 처리) -->
                <div class="ladder-game" id="ladderGame" style="display: none;">
                    <h2>사다리 타기</h2>
                    
                    <!-- 참가자 버튼들 -->
                    <div class="participant-buttons" id="participantButtons">
                        <!-- JavaScript로 동적 생성 -->
                    </div>

                    <!-- 모든 결과 보기 버튼 -->
                    <button class="show-all-button" id="showAllBtn">
                        <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M10 5V15M5 10L10 15L15 10" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                        모든 결과 보기
                    </button>

                    <!-- 사다리 캔버스 -->
                    <div class="ladder-canvas-wrapper">
                        <canvas id="ladderCanvas" class="ladder-canvas hidden"></canvas>
                        <div class="ladder-overlay" id="ladderOverlay">
                            <div class="ladder-overlay-text">🎲 사다리가 준비되었습니다!</div>
                            <div class="ladder-overlay-subtext">참가자 버튼을 클릭하여 결과를 확인하세요</div>
                        </div>
                    </div>

                    <!-- 결과/상품 표시 -->
                    <div class="prize-display" id="prizeDisplay">
                        <!-- JavaScript로 동적 생성 -->
                    </div>

                    <!-- 게임 결과 메시지 (숨김 처리) -->
                    <div class="result-message" id="resultMessage" style="display: none;">
                        <div id="resultList"></div>
                        <button class="retry-button" id="retryBtn" style="display: none;">
                            <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M17.5 10C17.5 14.142 14.142 17.5 10 17.5C5.858 17.5 2.5 14.142 2.5 10C2.5 5.858 5.858 2.5 10 2.5C11.683 2.5 13.25 3.025 14.542 3.917M17.5 2.5V6.667H13.333" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                            다시하기
                        </button>
                    </div>
                </div>

                <!-- 게임 방법 -->
                <div class="game-instructions">
                    <h3>게임 방법</h3>
                    <ul class="instruction-list">
                        <li><span class="bullet">•</span><span>참가자 수를 선택하고 참가자 이름과 결과/상품을 입력하세요.</span></li>
                        <li><span class="bullet">•</span><span>"사다리 생성" 버튼을 눌러 무작위 사다리를 생성합니다.</span></li>
                        <li><span class="bullet">•</span><span>참가자 버튼을 클릭하여 사다리를 타고 결과를 확인하세요.</span></li>
                        <li><span class="bullet">•</span><span>빨간 선이 경로를 표시하고 최종 결과를 알려줍니다.</span></li>
                    </ul>
                </div>
            </div>
        </main>
        
        <script th:src="@{/js/ladder.js}"></script>
    </body>
</html>