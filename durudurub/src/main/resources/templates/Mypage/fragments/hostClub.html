<!-- 리더인 모임 -->
    <div th:if="${type == 'HOST'}">
        <div class="tab-content" id="leader">
            <div th:each="club : ${myclubList}" class="club-card-wrapper">
                <div class="club-card" th:attr="data-club-no=${club.no}" style="cursor: pointer;">
                    <div class="club-info">
                        <div class="club-icon">
                            <span class="material-symbols-outlined">group</span>
                        </div>
                        <div class="club-details">
                            <div class="club-title-row">
                                <h3 class="club-title" th:text="${club.title}">모임명</h3>
                                <span class="material-symbols-outlined leader-crown">chess_queen</span>
                            </div>
                            <p class="club-category" th:text="${club.category != null ? club.category.name : '카테고리 없음'}">카테고리명</p>
                            <p class="club-members" th:text="|멤버 ${club.currentMembers}/${club.maxMembers}명|">가입 멤버수</p>
                        </div>
                    </div>
                    <div class="club-actions leader-actions">
                        <button class="btn-leader-manage" th:attr="data-club-no=${club.no}" onclick="memberList()">
                            <span>멤버 관리</span>
                            <span class="material-symbols-outlined">expand_more</span>
                        </button>
                        <button class="btn-leader-delete" onclick="event.stopPropagation();">
                            <span class="material-symbols-outlined">logout</span>
                            <span>모임 삭제</span>
                        </button>
                    </div>
                </div>
                
                <!-- 멤버 관리 영역 (토글) -->
                <!-- id="memberManagement"
                     -->
                <div class="member-management-area"  id="|memberManagement-${club.no}|" style="display: none;">
                    <!-- 가입 요청 섹션 -->
                    <div class="member-section">
                        <div class="member-section-header">
                            <span class="material-symbols-outlined section-icon pending-icon">schedule</span>
                            <h4 class="section-title">가입 요청 (<span text="${pendingList.size()}">0</span>)</h4>
                        </div>
                        <div class="member-list" each="pending : ${pendingList}">
                            <div if="${#lists.isEmpty(pending)}">가입 요청 없음</div>
                            <div class="member-item pending">
                                <div class="member-info">
                                    <p class="member-name" text="${m.user.username}">이름</p>
                                    <!-- 신청일 어ㅓ쩜...? -->
                                    <p class="member-date" text="|신청일: ${#temporals.format(m.joinedAt, 'yyyy-MM-dd')}|">신청일: yyyy-mm-dd</p>
                                </div>
                                <div class="member-actions">
                                    <button class="btn-approve" attr="data-member-no=${m.no},data-club-no=${clubNo}">
                                        <span class="material-symbols-outlined">check</span>
                                        <span>승인</span>
                                    </button>
                                    <button class="btn-reject" attr="data-member-no=${m.no},data-club-no=${clubNo}">
                                        <span class="material-symbols-outlined">close</span>
                                        <span>거부</span>
                                    </button>
                                </div>
                            </div>
                            <!-- <div class="member-item pending">
                                <div class="member-info">
                                    <p class="member-name">최지혜</p>
                                    <p class="member-date">신청일: 2025-01-27</p>
                                </div>
                                <div class="member-actions">
                                    <button class="btn-approve">
                                        <span class="material-symbols-outlined">check</span>
                                        <span>승인</span>
                                    </button>
                                    <button class="btn-reject">
                                        <span class="material-symbols-outlined">close</span>
                                        <span>거부</span>
                                    </button>
                                </div>
                            </div> -->
                        </div>
                    </div>

                    <!-- 승인된 멤버 섹션 -->
                    <div class="member-section">
                        <div class="member-section-header">
                            <!-- <h4 class="section-title">승인된 멤버 (<span text="${#lists.size(approvedList)}">0</span>)</h4> -->
                        </div>
                        <div class="member-list">
                            <div if="${#lists.isEmpty(approvedList)}">멤버 없음</div>
                            <div each="m : ${approvedList}" class="member-item approved">
                                <div class="member-info">
                                    <p class="member-name" text="${m.user.username}">이름</p>
                                    <p class="member-date" text="|가입일: ${#temporals.format(m.joinedAt, 'yyyy-MM-dd')}|">가입일: yyyy-mm-dd</p>
                                </div>
                                <button class="btn-remove-member" attr="data-member-no=${m.no},data-club-no=${clubNo}">추방하기</button>
                            </div>
                            <!-- <div class="member-item approved">
                                <div class="member-info">
                                    <p class="member-name" th:text="${user.username}">이영희</p>
                                    <p class="member-date" th:text="$clubmember.joinedAt">가입일: 2025-01-20</p>
                                </div>
                                <button class="btn-remove-member">추방하기</button>
                            </div> -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 모임 삭제 모달 -->
    <div id="deleteClubModal" class="delete-modal">
        <div class="delete-modal-content">
            <div class="delete-modal-header">
                <h3 class="delete-modal-title">모임 삭제</h3>
                <button id="deleteModalCloseBtn" class="delete-modal-close">
                    <span class="material-symbols-outlined">close</span>
                </button>
            </div>
            <div class="delete-modal-warning">
                <p class="delete-modal-warning-title">
                    <span class="delete-club-name">사진 촬영 동호회</span> 모임을 삭제하시겠습니까?
                </p>
                <p class="delete-modal-warning-text">삭제하면 해당 모임은 영구적으로 삭제됩니다.</p>
            </div>
            <div class="delete-modal-actions">
                <button id="deleteModalCancelBtn" class="delete-modal-btn delete-modal-btn-cancel">취소</button>
                <button id="deleteModalConfirmBtn" class="delete-modal-btn delete-modal-btn-confirm">삭제하기</button>
            </div>
        </div>
    </div>

    <!-- 멤버 승인 모달 -->
    <div id="approveMemberModal" class="approve-modal">
        <div class="approve-modal-content">
            <div class="approve-modal-header">
                <h3 class="approve-modal-title">멤버 승인</h3>
                <button id="approveModalCloseBtn" class="approve-modal-close">
                    <span class="material-symbols-outlined">close</span>
                </button>
            </div>
            <div class="approve-modal-info">
                <p class="approve-modal-info-title">
                    <span class="approve-member-name">박민수</span>님의 가입을 승인하시겠습니까?
                </p>
                <p class="approve-modal-info-text">승인하면 멤버가 모임에 참여하여 게시글 작성 및 활동이 가능합니다.</p>
            </div>
            <div class="approve-modal-actions">
                <button id="approveModalCancelBtn" class="approve-modal-btn approve-modal-btn-cancel">취소</button>
                <button id="approveModalConfirmBtn" class="approve-modal-btn approve-modal-btn-confirm">승인하기</button>
            </div>
        </div>
    </div>

    <!-- 멤버 거부 모달 -->
    <div id="rejectMemberModal" class="reject-modal">
        <div class="reject-modal-content">
            <div class="reject-modal-header">
                <h3 class="reject-modal-title">가입 거부</h3>
                <button id="rejectModalCloseBtn" class="reject-modal-close">
                    <span class="material-symbols-outlined">close</span>
                </button>
            </div>
            <div class="reject-modal-warning">
                <p class="reject-modal-warning-title">
                    <span class="reject-member-name">박민수</span>님의 가입을 거부하시겠습니까?
                </p>
                <p class="reject-modal-warning-text">거부하면 해당 사용자는 모임에 참여할 수 없습니다.</p>
            </div>
            <div class="reject-modal-actions">
                <button id="rejectModalCancelBtn" class="reject-modal-btn reject-modal-btn-cancel">취소</button>
                <button id="rejectModalConfirmBtn" class="reject-modal-btn reject-modal-btn-confirm">거부하기</button>
            </div>
        </div>
    </div>

    <!-- 멤버 추방 모달 -->
    <div id="removeMemberModal" class="remove-modal">
        <div class="remove-modal-content">
            <div class="remove-modal-header">
                <h3 class="remove-modal-title">멤버 내보내기</h3>
                <button id="removeModalCloseBtn" class="remove-modal-close">
                    <span class="material-symbols-outlined">close</span>
                </button>
            </div>
            <div class="remove-modal-warning">
                <p class="remove-modal-warning-title">
                    <span class="remove-member-name">김철수</span>님을 모임에서 내보내시겠습니까?
                </p>
                <p class="remove-modal-warning-text">내보내면 해당 멤버는 더 이상 모임 활동을 할 수 없습니다.</p>
            </div>
            <div class="remove-modal-actions">
                <button id="removeModalCancelBtn" class="remove-modal-btn remove-modal-btn-cancel">취소</button>
                <button id="removeModalConfirmBtn" class="remove-modal-btn remove-modal-btn-confirm">내보내기</button>
            </div>
        </div>
    </div>
<th:block th:replace="~{fragments/scripts :: scripts}">
<script>
    
// ⭐ 리더인 모임
// 멤버 관리 토글
// function memberList() {
    
// }
// $(document).on("click", ".btn-leader-manage", function(e){
//   e.stopPropagation();

//   const clubNo = $(this).data("club-no");
//   const $area = $("#memberManagement-" + clubNo);
//   const $icon = $(this).find(".material-symbols-outlined:last");

//   if ($area.length === 0) return;
//   const isOpen = $area.is(":visible");

//   // ⭐ 애니메이션 없이 즉시 토글
//   $area.toggle();
//   $icon.text(isOpen ? "expand_more" : "expand_less");

//   if(!isOpen){
//     loadMembers(clubNo, $area);
//   }
// });

// function loadMembers(clubNo, $area){

//     $.ajax({
//         url: `/users/mypage/club/${clubNo}/members`,
//         method: 'GET',
//         dataType: 'json',
//             success: function(res) {
//             const pendingList = res.pendingList || [];
//             const approvedList = res.approvedList || [];

//             // ✅ 이 영역 안에서만 찾기
//             const $pendingCount = $area.find(".countPending");
//             const $approvedCount = $area.find(".countApproved");
//             const $pendingBox = $area.find(".pendingList");
//             const $approvedBox = $area.find(".approvedList");

//             $pendingCount.text(pendingList.length);
//             $approvedCount.text(approvedList.length);

//             // pending
//             let pendingHtml = "";
//             pendingList.forEach(m => {
//             pendingHtml += 
//             `
//                 <div class="member-item pending">
//                 <div class="member-info">
//                     <p class="member-name">${m.user.username}</p>
//                     <p class="member-date">신청일: ${formatDate(m.joinedAt)}</p>
//                 </div>
//                 <div class="member-actions">
//                     <button class="btn-approve" data-member-no="${m.no}" data-club-no="${clubNo}">
//                     <span class="material-symbols-outlined">check</span><span>승인</span>
//                     </button>
//                     <button class="btn-reject" data-member-no="${m.no}" data-club-no="${clubNo}">
//                     <span class="material-symbols-outlined">close</span><span>거부</span>
//                     </button>
//                 </div>
//                 </div>
//             `
//             })

//             if(!pendingHtml) pendingHtml = `<p>가입 요청 없음</p>`
//             $pendingBox.html(pendingHtml)

//             // approved
//             let approvedHtml = ""
//             approvedList.forEach(m => {
//             approvedHtml += 
//             `
//                 <div class="member-item approved">
//                 <div class="member-info">
//                     <p class="member-name">${m.user.username}</p>
//                     <p class="member-date">가입일: ${formatDate(m.joinedAt)}</p>
//                 </div>
//                 <button class="btn-remove-member" data-member-no="${m.no}" data-club-no="${clubNo}">
//                     추방하기
//                 </button>
//                 </div>
//             `
//             })
//             if(!approvedHtml) approvedHtml = `<p>멤버 없음</p>`
//             $approvedBox.html(approvedHtml);
//         }
//   })
// }

// 날짜 포맷

// fetch(`/users/mypage/club/${clubNo}/members`)
//     .then(res => res.json())
//     .then(data => {
//         console.log(data.pendingList)
//     })

// function formatDate(dateStr){
//   if(!dateStr) return ''

//   const d = new Date(dateStr)
//   const yyyy = d.getFullYear()
//   const mm = String(d.getMonth()+1).padStart(2,'0')
//   const dd = String(d.getDate()).padStart(2,'0')

//   return `${yyyy}-${mm}-${dd}`
// }
// 모임 삭제
</script>
</th:block>